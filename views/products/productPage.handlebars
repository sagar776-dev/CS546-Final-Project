<script src="/public/js/reviews.js"></script>

<div class="container product-page">
  {{#if error}}
    <p class="error text-danger">{{error}}</p>
  {{/if}}

  <div class="product-info row">
    <div class="col-sm-6">
      <h2>{{product.name}}</h2>
      <p>Category: {{product.category}}</p>
      <p>Manufacturer: {{product.manufacturer}}</p>
      <p>Price: {{product.price}}</p>
      <p>Start Date: {{product.startDate}}</p>
      <p>In-store Availability: {{product.inStoreAvailability}}</p>
    </div>
    <div class="col-sm-6">
      <p>Best Buy Rating: {{product.customerReviewAverage}}</p>
      <p>LookUpDevice Users Rating: {{product.overallRating}}</p>
    </div>
  </div>

  <div id="product-images" class="carousel">
    {{#each pictures}}
      <img src={{this}} alt={{this}} width="300" height="250" class="img-fluid" />
    {{/each}}
  </div>

  <div class="actions mt-3">
    {{#if isWishlisted}}
      <p>
        <a href="/users/removewishlist/{{product._id}}" class="btn btn-danger btn-xs">Remove from wishlist</a>
      </p>
    {{else}}
      <p>
        <a href="/users/addwishlist/{{product._id}}" class="btn btn-success btn-xs">Add to wishlist</a>
      </p>
    {{/if}}

    <p>
      <button id="compare" class="btn btn-success btn-xs" onclick="addToCompare({{product._id}})" type="button">Add to Compare</button>
    </p>
    <button type="button" class="btn btn-danger" id="clear-storage">Clear LocalStorage</button>
  </div>

  <h3 class="mt-3">Description:</h3>
  <p>{{product.description}}</p>

  <h3 class="mt-3">Details:</h3>
  <table class="table table-striped">

    <tr>
      <th>Name</th>
      <th>Spec</th>
    </tr>
    {{#each details}}
      <tr>
        <td>{{name}}</td>
        <td>{{value}}</td>

      </tr>
    {{/each}}
  </table>


  <a href="/api/qna/{{product._id}}" class="btn btn-primary">Ask a Question</a>
  <a href="/api/reviews/{{product._id}}" class="btn btn-primary">Add a review</a>


  <table class="table table-striped">
    {{#each product.qna}}
    <thead>
      <tr>
        <th>Question</th>
        <th>Answer</th>
        <th>Author</th>
        <th>Date</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>{{question}}</td>
        {{#if answer}}
        <td>{{answer.answer}}</td>
        <td>{{answer.author}}</td>
        <td>{{answer.date}}</td>
        <td></td>
        {{else}}
        <td colspan="3">No answer yet</td>

        <td><a href="/api/qna/answer/{{_id}}" class="btn btn-primary">Add Answer</a></td>
        {{/if}}
      </tr>
      {{/each}}
    </tbody>
  </table>

  <div class="container">
    {{#each product.reviews}}
    <div class="card mt-4">
      <div class="card-header">
        <h4>{{reviewTitle}}</h4>
        <p>By {{reviewerName}} on {{reviewDate}}</p>
      </div>
      <div class="card-body">
        <p>{{review}}</p>
        {{#if pictures}}
        <div class="row mt-4">
          {{#each pictures}}
          <div class="col-md-3">
            <img src="{{this}}" class="img-fluid">
          </div>
          {{/each}}
        </div>
        {{/if}}
      </div>
      <div class="card-footer d-flex justify-content-between">
        <button class="btn btn-primary like-btn" data-review-id="{{_id}}">Like ({{like}})</button>
        <button class="btn btn-secondary dislike-btn" data-review-id="{{_id}}">Dislike ({{dislike}})</button>
      </div>
    </div>
    {{/each}}
  </div>

  </article>

</div>

